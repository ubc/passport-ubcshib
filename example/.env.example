# @ubcshib/passport-ubcshib Configuration Example
# Copy this file to .env and fill in your specific values

# ============================================================================
# ENVIRONMENT SELECTION
# ============================================================================
# Choose STAGING for testing, PRODUCTION for live deployment
SAML_ENVIRONMENT=STAGING

# ============================================================================
# SERVICE PROVIDER CONFIGURATION
# ============================================================================
# Your application's entity ID - should be your app's base URL with /shibboleth suffix
SAML_ISSUER=https://myapp.example.com/shibboleth

# The callback URL where the IdP will send users after authentication
# Must match exactly with what's registered with UBC IAM
SAML_CALLBACK_URL=https://myapp.example.com/auth/ubcshib/callback

# ============================================================================
# CERTIFICATE AND KEY CONFIGURATION
# ============================================================================
# Path to your application's private key for signing SAML requests
# This file should contain your PEM-formatted private key
# Make sure this file has restrictive permissions (e.g., 0600)
SAML_PRIVATE_KEY_PATH=/path/to/your/private.key

# Optional: If you need to specify the IdP certificate explicitly
# (usually not needed - it's fetched from metadata automatically)
# SAML_CERT=/path/to/idp-certificate.pem

# Optional: Custom IdP metadata URL
# (uses defaults for STAGING/PRODUCTION if not specified)
# SAML_METADATA_URL=https://authentication.stg.id.ubc.ca/idp/shibboleth

# Optional: Custom IdP entry point (SSO URL)
# SAML_ENTRY_POINT=https://authentication.stg.id.ubc.ca/idp/profile/SAML2/Redirect/SSO

# Optional: Custom logout URL
# SAML_LOGOUT_URL=https://authentication.stg.id.ubc.ca/idp/profile/Logout

# ============================================================================
# FEATURE CONFIGURATION
# ============================================================================
# Enable single logout (SLO) - logs out user from IdP when they log out
ENABLE_SLO=true

# ============================================================================
# ATTRIBUTE CONFIGURATION
# ============================================================================
# Comma-separated list of attributes to request from the IdP
# Available attributes:
#   - ubcEduCwlPuid: UBC Computing User ID
#   - mail: Email address
#   - eduPersonAffiliation: User's affiliation (student, faculty, staff, etc.)
#   - givenName: First name
#   - sn: Last name
#   - displayName: Display name
#   See ATTRIBUTES.md for complete list
SAML_ATTRIBUTES=ubcEduCwlPuid,mail,eduPersonAffiliation

# ============================================================================
# SECURITY CONFIGURATION
# ============================================================================
# SAML signature algorithm (sha256, sha512, etc.)
# SAML_SIGNATURE_ALGORITHM=sha256

# Allowed clock skew in milliseconds between servers (default: 0)
# Increase this if you have time synchronization issues
# SAML_ACCEPTED_CLOCK_SKEW_MS=0

# Validate InResponseTo field in SAML responses (recommended: true)
# SAML_VALIDATE_IN_RESPONSE_TO=true

# ============================================================================
# LOGGING AND DEBUGGING
# ============================================================================
# Enable debug logging (set to 'true' for development only)
DEBUG=false

# Log level (debug, info, warn, error)
LOG_LEVEL=info

# ============================================================================
# NOTES FOR DEVELOPMENT
# ============================================================================
# 1. Generate your private key and certificate:
#    openssl req -new -x509 -days 365 -nodes \
#      -out key.crt -keyout key.pem
#
# 2. Update SAML_ISSUER and SAML_CALLBACK_URL to match your development URLs
#
# 3. For local development without HTTPS:
#    - You may need to set NODE_TLS_REJECT_UNAUTHORIZED=0 (insecure - dev only!)
#    - UBC IAM typically requires HTTPS even for staging
#
# 4. To test with UBC staging:
#    - Contact UBC IAM with your entity ID (SAML_ISSUER)
#    - Provide them your metadata (generated by the strategy)
#    - Wait for approval before testing
#
# 5. Never commit the actual .env file with real keys/certificates!
